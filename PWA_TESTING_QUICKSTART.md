# Justice Companion PWA - Quick Testing Guide

## Test PWA Locally (5 minutes)

### Step 1: Build Production PWA
```bash
npm run build
```
Expected output: "PWA v1.1.0", service worker generated

### Step 2: Preview Production Build
```bash
npm run preview
```
Expected: Server starts at http://localhost:4173

### Step 3: Open in Chrome
```
http://localhost:4173
```

### Step 4: Verify PWA (Chrome DevTools F12)

#### A. Check Manifest
1. DevTools → **Application** tab
2. Left sidebar → **Manifest**
3. Verify:
   - Name: "Justice Companion - UK Legal AI Assistant"
   - Short name: "JusticeAI"
   - Icons: 3 icons visible (192x192, 512x512)
   - Start URL: "/"
   - Display: "standalone"
   - Theme color: "#1e40af"

#### B. Check Service Worker
1. DevTools → **Application** tab
2. Left sidebar → **Service Workers**
3. Verify:
   - Status: "activated and is running"
   - Source: "sw.js"
   - Scope: entire domain

#### C. Check Cache Storage
1. DevTools → **Application** tab
2. Left sidebar → **Cache Storage**
3. Expand caches
4. Verify entries exist

#### D. Check Install Prompt
1. Look for install button in Chrome address bar (desktop icon)
2. OR look for blue banner at bottom: "Install Justice Companion"
3. Click "Install Now" to test installation

### Step 5: Test Installation

#### Desktop (Chrome/Edge)
1. Click install button in address bar
2. App window should open in standalone mode
3. Check Start Menu / Desktop for "Justice Companion" icon

#### Mobile (Chrome on Android)
1. Open preview URL on phone
2. Chrome will show "Add to Home Screen" banner
3. Tap "Install" or "Add"
4. Icon appears on home screen
5. Tap icon → app opens fullscreen

#### Mobile (Safari on iPhone)
1. Open preview URL on iPhone
2. Tap Share button (square with arrow)
3. Scroll down → "Add to Home Screen"
4. Confirm → icon appears on home screen

### Step 6: Run Lighthouse Audit
1. DevTools → **Lighthouse** tab
2. Categories: Select "Progressive Web App"
3. Device: Desktop or Mobile
4. Click "Analyze page load"
5. **Target Score: 100/100**

---

## Expected Results

### PWA Checklist (All should be ✓)
- [x] Installable
- [x] Service worker registered
- [x] Manifest valid
- [x] Icons present
- [x] Offline ready
- [x] HTTPS ready (localhost exempt)
- [x] Standalone display
- [x] Theme color set

### Visual Indicators
- Install button in browser address bar
- Blue install banner at bottom of page
- Service worker badge in DevTools (green dot)
- Cached assets in Cache Storage

---

## Troubleshooting

### "No install button appears"
- **Check:** DevTools → Application → Manifest (all fields valid?)
- **Check:** Service worker registered and running?
- **Try:** Hard refresh (Ctrl+Shift+R)
- **Try:** Clear cache and reload

### "Service worker not registering"
- **Check:** Are you on http://localhost? (HTTPS required except localhost)
- **Check:** Console for errors
- **Fix:** Clear service workers in DevTools → Application → Service Workers → Unregister

### "Icons not showing"
- **Check:** Files exist: `public/pwa-192x192.png`, `public/pwa-512x512.png`
- **Check:** Icons are valid PNG files (not corrupted)
- **Fix:** Regenerate icons using `public/icon-generator.html`

### "Manifest errors"
- **Check:** DevTools → Application → Manifest
- **Look:** Red error messages
- **Fix:** Manifest is generated by Vite PWA plugin (check vite.config.mts)

---

## Quick Commands Reference

```bash
# Full development environment
npm run start:full

# Development mode only (Vite)
npm run dev

# Production build
npm run build

# Preview production build
npm run preview

# Type checking
npm run type-check

# Lint code
npm run lint
```

---

## Production Icon Replacement (Before Deployment)

Current icons are placeholders. Replace before production:

### Option 1: Browser Generator
```
1. Open public/icon-generator.html in browser
2. Download all 3 PNG files
3. Replace files in public/ directory
```

### Option 2: Online Tool
```
1. Visit https://realfavicongenerator.net/
2. Upload public/icon-template.svg
3. Download package
4. Extract and copy:
   - android-chrome-192x192.png → pwa-192x192.png
   - android-chrome-512x512.png → pwa-512x512.png
   - apple-touch-icon.png → apple-touch-icon.png
5. Place in public/ directory
```

---

## Environment Configuration

### Development (Local)
Uses `.env.development`:
```
VITE_API_URL=http://localhost:8000
```

### Production (Cloud)
Uses `.env.production`:
```
VITE_API_URL=https://justice-companion.up.railway.app
```

Before deployment, update `.env.production` with your actual Railway backend URL.

---

## Success Indicators

If everything works:
1. Chrome shows install button/banner ✓
2. Lighthouse PWA score: 100/100 ✓
3. Service worker: activated ✓
4. App installs to home screen/desktop ✓
5. Standalone mode works ✓
6. Icons display correctly ✓

You're ready for production deployment!

---

**Quick Test Time:** ~5 minutes
**Full Test Time:** ~15 minutes (including real device testing)
**Next:** Deploy backend to Railway, then frontend to Netlify
